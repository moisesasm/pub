  
trigers 
falha mysql {XXXX:mysql.backup_inc.str(ERROR 2002)}=1
nao rodou ou com atraso {XXXX:mysql.backup_full.strlen(#2)}<=0
falha backup {XXXX:mysql.backup_full.str(Falha)}=1 or {XXXX:mysql.backup_full.str(Error)}=1
------derrubar socket tcp
 ss -K dst 201.62.74.88
 
 Ativar win
slmgr.vbs -ato

cd /var/lib/tomcat7/conf/
sudo keytool -genkey -alias mykey -keyalg RSA -keysize 1024 -validity 365 -keypass painel -keystore /var/lib/tomcat7/conf/painel.jks -storepass painel

sudo vi server.xml
 netstat -n|grep tcp|awk '{ print $5}'|cut  -d ":" -f1|uniq -c |sort -r
 lsof -i:3050 |awk '{ print $9}'|cut -d ">" -f2 |cut -d ":" -f1|uniq -c|sort -r
 
 snmpwalk -v1 -c public xxx.xxx.xxx.xxx 1.3.6.1.2.1.1.3
 
 
  Port {$BILLING_PORT} is closed	{XXXX:net.tcp.listen[{$BILLING_PORT}].sum(120)}=0
  
  
sslcheck 

data=`echo | openssl s_client -servername $1 -connect $1:$2 2>/dev/null | openssl x509 -noout -enddate | sed -e 's#notAfter=##'`
ssldate=`date -d "${data}" '+%s'`
nowdate=`date '+%s'`
diff="$((${ssldate}-${nowdate}))"
echo $((${diff}/86400))

item
system.run[/usr/lib/zabbix/alertscripts/sslchk.sh contmatic.com.br 443
num float
trigg
{Zabbix server:system.run[/usr/lib/zabbix/alertscripts/sslchk.sh contmatic.com.br 443].last(#2)}<=5

squid
UserParameter=wget.youtube,HOME=/etc/zabbix wget --server-response googlevideo.com 2>&1 | awk '/^  HTTP/{print $2}'|tail -n 1
UserParameter=wget.facebook,HOME=/etc/zabbix wget --server-response facebook.com 2>&1 | awk '/^  HTTP/{print $2}'|tail -n 1
UserParameter=wget.xxx,HOME=/etc/zabbix wget --server-response xxx.com 2>&1 | awk '/^  HTTP/{print $2}'|tail -n 1
{CONTSTRTB01:wget.xxx.last()}=200

###scripts frontend ###
Detect operating system	Script	Server	: sudo /usr/bin/nmap -O {HOST.CONN} 2>&1	Zabbix administrators	All	Read
	echo file	Script	Agent	:sudo echo "`date` teste" >> /tmp/testezabix.txt	All	All	Read
	lsof - Top IP´s	Script	Agent	:sudo lsof -i |awk '{ print $9}'|cut -d ">" -f2 |cut -d ":" -f1|uniq -c|sort -n	All	All	Read
	nestat - Top IP´s TCP nestat	Script	Agent:	netstat -n|grep tcp|awk '{ print $5}'|cut -d ":" -f1|uniq -c |sort -r	All	All	Read
	nestat - Top IP´s UDP nestat	Script	Agent:	netstat -n|grep udp|awk '{ print $5}'|cut -d ":" -f1|uniq -c |sort -r	All	All	Read
	Ping	Script	Server:	/bin/ping -c 3 {HOST.CONN} 2>&1	All	All	Read
	SpeedTest CTI	Script	Server:	python /usr/bin/speedtest	All	All	Read
	sudo sh	Script	Agent:	sudo sh -c /home/xxx/threadDump.sh	All	All	Read
	Teste SMS	Script	Server:	sh /usr/lib/zabbix/alertscripts/sms_notify.sh +55119992 "Zabbix Test MSG From {HOST.CONN}"	All	All	Read
	Traceroute	Script	Server:	/usr/bin/traceroute {HOST.CONN} 2>&1	All	All	Read
	Validacao Certificado	Script	Server:	/usr/lib/zabbix/alertscripts/sslchk.sh painel.softmatic.com.br 8443	All	All	Read
	Wget	Script	Server:	/usr/bin/wget {HOST.CONN}	All	All	Read
	Zabbix agent Ping Test	Script	Server:	zabbix_get -s {HOST.CONN} -k agent.ping
  ####

CPU%  Linux
Type Zabbbix Agent
Key system.cpu.util[all,user,avg1]
Type Information Numeric float
Unit %
Trigger (Uso de CPU chegou a 95% ou mais por 7 minutos) 
{SO Linux:system.cpu.util[all,user,avg1].last(#7)}>=95

mem trigger {XXX:vm.memory.size[available].last(0)}<5G

process>
APP Billing caiu	{XXX:jdk_billing_pid.strlen(#2)}<=0	Enabled		Warning	APP Billing reiniciado	{XXX:jdk_billing_pid.diff(0)}>0	Enabled	
APP Transportes caiu	{XXXX:jdk_transportes_pid.strlen(#2)}<=0	Enabled	
APP Transportes reiniciado	{XXX:jdk_transportes_pid.diff(0)}>0 and {XXX:jdk_transportes_pid.nodata(1)}=1

CPU%  Windows
Type Zabbbix Agent
Key system.cpu.util[all,user,avg1]
Type Information Numeric float
Unit %



snmpwalk -v1 -c public 192.168.x.166 .1.3.6.1.4.1.21067.2.1.2.6.0

openssl pkcs12 -export -out certificate.pfx -inkey privkey.pem -in cert.pem

letsenc
https://github.com/acmesh-official/acme.sh


#./acme.sh  --issue -d *.xx.com.br --dns --yes-I-know-dns-manual-mode-enough-go-ahead-please --renew --debug
RENEW
./acme.sh  --issue -d *.xx.xx.com.br --dns --yes-I-know-dns-manual-mode-enough-go-ahead-please --debug --renew
#NEW
#./acme.sh  --issue -d *.xx.xx.com.br --dns --yes-I-know-dns-manual-mode-enough-go-ahead-please --debug



